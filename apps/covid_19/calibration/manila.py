from autumn.constants import Region
from apps.covid_19.calibration import base
from apps.covid_19.calibration.base import (
    provide_default_calibration_params,
    add_standard_dispersion_parameter,
    add_standard_philippines_params,
    assign_trailing_weights_to_halves,
)


def run_calibration_chain(max_seconds: int, run_id: int, num_chains: int):
    base.run_calibration_chain(
        max_seconds,
        run_id,
        num_chains,
        Region.MANILA,
        PAR_PRIORS,
        TARGET_OUTPUTS,
        mode="autumn_mcmc",
    )

# START CALIBRATION VALUES
# Notification data:
notification_times = [
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
88,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
202,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
]

notification_values = [
6,
9,
16,
30,
38,
44,
48,
54,
59,
62,
64,
71,
80,
91,
98,
108,
113,
113,
118,
125,
129,
135,
140,
145,
147,
143,
143,
147,
153,
151,
149,
152,
160,
170,
179,
185,
194,
204,
206,
204,
195,
187,
176,
166,
159,
155,
157,
161,
155,
151,
152,
153,
150,
152,
151,
153,
161,
159,
156,
153,
151,
153,
159,
159,
171,
174,
180,
183,
185,
181,
182,
178,
180,
180,
183,
195,
207,
219,
222,
225,
228,
215,
199,
197,
195,
197,
192,
186,
195,
208,
216,
217,
218,
216,
220,
235,
242,
234,
248,
248,
250,
256,
257,
259,
274,
284,
305,
338,
352,
367,
397,
435,
476,
516,
525,
541,
604,
677,
746,
797,
852,
903,
937,
961,
1003,
1029,
1092,
1144,
1201,
1245,
1284,
1313,
1388,
1430,
1489,
1536,
1541,
1561,
1622,
1662,
1720,
1770,
1802,
1830,
1887,
1927,
1927,
1904,
1838,
1777,
1791,
1760,
1710,
1680,
1648,
1659,
1673,
1677,
]

# ICU data:
icu_times = [
110,
117,
124,
131,
138,
145,
152,
159,
166,
173,
180,
187,
194,
201,
208,
215,
222,
]

icu_values = [
93,
188,
224,
247,
229,
224,
222,
226,
219,
224,
236,
246,
294,
359,
368,
385,
418,
]

# END CALIBRATION VALUES

TARGET_OUTPUTS = [
    {
        "output_key": "notifications",
        "years": notification_times,
        "values": notification_values,
        "loglikelihood_distri": "negative_binomial",
        "time_weights": assign_trailing_weights_to_halves(5, notification_times),
    },
    {
        "output_key": "icu_occupancy",
        "years": icu_times,
        "values": icu_values,
        "loglikelihood_distri": "negative_binomial",
        "time_weights": list(range(1, len(icu_times) + 1)),
    },
]

PAR_PRIORS = provide_default_calibration_params()
PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "notifications")
PAR_PRIORS = add_standard_dispersion_parameter(PAR_PRIORS, TARGET_OUTPUTS, "icu_occupancy")
PAR_PRIORS = add_standard_philippines_params(PAR_PRIORS)
