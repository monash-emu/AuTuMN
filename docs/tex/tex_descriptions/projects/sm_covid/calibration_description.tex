\section{Model calibration and uncertainty propagation}
\label{calibration}
The model was calibrated using a Bayesian approach. In particular, we used the Adaptive Differential Evolution Metropolis 
(DEMetropolisZ) algorithm implemented with the \textit{PyMC} Python package (v.5.2.0) to sample parameters from their 
posterior distributions. For each country, we ran 8 independent DEMetropolisZ chains of 35,000 iterations, each 
starting from a different starting point and using the first 5,000 draws for algorithm tuning. 
To determine the 8 starting points of the DEMetropolisZ chains, we conducted 8 independent optimisation 
searches using the Covariance Matrix Adaptation Evolution Strategy (CMA-ES) method, implemented with the
\textit{nevergrad} Python package (v.0.6.0) and with a budget of 10,000 model evaluations per search. 
The 8 optimisation searches' initial points were randomly drawn from Latin Hypercube Sampling (LHS) based on the parameter priors shown in Table \ref{param_table}. 
The parameters sampled with LHS were the transmission probability per contact, the IFR multiplier, 
the uncertainty multiplier for school contacts, and the proportion of students on-site during “Partially open” periods. 
The random process variables $W(t)$ (Section \ref{random_process}) were all set to 0 for each optimisation starting point.

Our calibration approach required a total of 360,000 ($8 \times (10000 + 35000)$) model evaluations per country analysis, which were completed in about two hours on a machine with 8 cpus and 32-GiB memory.

For each country, the results presented in the manuscript are associated with 1000 parameter sets randomly sampled from 
the posterior distributions obtained from DEMetropolisZ sampling (after discarding the first 25,000 iterations for each chain). 
The definitions of the prior distributions and the likelihood are detailed in the following sections.

\subsection{Parameters varied during calibration}

The parameters varied during calibration along with their associated prior distributions 
are listed in Table \ref{param_table} and indicated with the superscript \textsuperscript{C}.
We used uniform prior distributions for all calibrated parameters. The primary parameters varied during calibration are 
the unadjusted risk of transmission per contact ($\beta$), the IFR multiplier ($m_C$), the original infection seeding time,
the proportion of students on-site during ``Partially open'' periods, and the uncertainty multiplier modifying the school 
contacts' contribution ($m_S$). 

Note that the values of the random process $W_t$ described in Section \ref{random_process} are also treated as calibrated parameters by the MCMC. The Gaussian 
auto-regressive component described in Equation \ref{eq:random_process} is incorporated in the posterior likelihood 
computation (Section \ref{likelihood}).

\subsection{Calibration targets}
\label{targets}
Model calibration was performed independently for each country. All models were fitted to the reported number of COVID-19 deaths over time.
We used the daily number of COVID-19 deaths reported by WHO and applied a 7-day moving average to the observed data. 

\input{../../tex_descriptions/projects/sm_covid/serodata.tex}

\subsection{Likelihood definition}
\label{likelihood}
Let $d_w$ denote the rounded average daily number of COVID-19 deaths during week $w$, and $\hat{d_w}^\theta$ 
the associated predicted number of deaths according to the model with parameter set $\theta$. 

For countries with seroprevalence data, let us denote $\pi$ the measured seroprevalence proportion extracted from SeroTracker (Section \ref{targets}). 
Let $\hat{\pi}^\theta$ denote the modelled age-matched proportion ever infected by the time the survey was conducted (using the midpoint date) 
associated with the parameter set $\theta$. 
The likelihood was defined as follows for countries with seroprevalence data:

\begin{equation}
    \label{eq:likelihood}
    \mathcal{L}(\theta) := f_{\sigma}(\pi | \hat{\pi}^\theta) \times \prod_w g_r(d_w | \:\hat{d_w}^\theta) \quad ,
\end{equation}
where $f_{\sigma}( . | \mu )$ is the probability density function of a $[0, 1]$-truncated normal distribution with mean $\mu$ and standard deviation $\sigma$; and 
$g_r(. | \mu)$ is the probability mass function of a negative binomial distribution with mean $\mu$ and 
overdispersion parameter $r$. The overdispersion parameter $r$ was automatically estimated by the MCMC algorithm, while the standard deviation $\sigma$ was set to different 
values depending on the SeroTracker-reported risk of bias associated with the seroprevalence estimate ($\sigma=0.05$ if ``Low'', $\sigma=0.1$ if ``Moderate'', $\sigma=0.2$ if ``High''). 

For countries without seroprevalence data, the likelihood equation reduces to:
\begin{equation}
    \label{eq:likelihood_nosero}
    \mathcal{L}(\theta) := \prod_w g_r(d_w | \:\hat{d_w}^\theta) \quad.
\end{equation}

The likelihood functions described above represent the goodness of fit of a particular model parameterisation with regards to the targeted data. 
This quantity needs to be adjusted for the prior likelihood of the parameter set in order to compute the MCMC acceptance quantity $\mathcal{Q}(\theta)$.
As we used uniform priors for all the parameters, the inclusion of the individual parameters' priors in the acceptance quantity is not necessary. 
Indeed, their respective contributions would cancel out as the same quantity would appear in the numerator and the denominator of the 
MCMC acceptance quantity ratio. However, the auto-regressive relationship described in Equation \ref{eq:random_process}
must be accounted for as part of the combined prior likelihood of a parameter set. This prevents unrealistically large fluctuations of the random process.
If $W^\theta$ represents the random process associated with the parameter set $\theta$, the overall MCMC acceptance quantity is obtained by:

\begin{equation}
    \label{eq:acc_qtt}
    \begin{split}
    \mathcal{Q}(\theta) & = \mathcal{L}(\theta) \times \prod_{i=1}^{n} z_{W^\theta_{i-1},\epsilon}(W^\theta_i) \quad ,
    \end{split}
\end{equation}
where $z_{\mu,\epsilon}(.)$ represents the probability density function of the normal distribution $\mathcal{N}(\mu, \epsilon)$, and $n$ is the number 
of random process updates.


